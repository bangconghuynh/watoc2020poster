% !TeX document-id = {555063d9-c49e-4e5d-bcc1-5d7d130c26f4}
% !TeX program = lualatex
% !TeX TXS-program:bibliography = txs:///biber

\documentclass[final, xcolor={svgnames}]{beamer}

\input{preamble}

% =====
% Title
% =====

\title{On Symmetry and Degeneracy\\ in the Construction of the Adiabatic Connection\\ Based on the Lieb Variational Principle}

\author{\underline{Bang C. Huynh}\inst{1} \and Andrew M. Teale\inst{1}}

\institute[Chemistry, Nottingham, UK]{\inst{1} School of Chemistry, University of Nottingham, United Kingdom}

% ====
% Body
% ====

\begin{document}

\begin{frame}[t]
\begin{columns}[t]
  \separatorcolumn

  \begin{column}{\colwidth}
    \begin{block}{1. The Exact Adiabatic Connection (AC)}
      For an $\gls*{gen:Ne}$-electron system, consider a $\lambda$-parametrised electronic Hamiltonian
      \begin{equation*}
        \gls*{op:hamil}[_{\lambda}](\gls*{op:pot1e}_{\lambda})
        =
        \gls*{op:kin}
        + \lambda \gls*{op:ee}
        + \sum_{i=1}^{\gls*{gen:Ne}} \gls*{op:pot1e}_{\lambda}(\gls*{bas:spatialcoord}[_i]),
        \quad
        \textrm{where}
        \quad
        \gls*{op:ee} = \sum_{i=1}^{\gls*{gen:Ne}}\sum_{j>i}^{\gls*{gen:Ne}} \frac{1}{\lvert \gls*{bas:spatialcoord}[_i] - \gls*{bas:spatialcoord}[_j] \rvert},
      \end{equation*}
      that continuously links the \emphbold{LightSalmon}{physical system} to the \emphbold{LightSeaGreen}{non-interacting system}.

%      \tikzextrue
      \tikzexternalenable
      \begin{figure}
        \centering
        \useexternalfile{0.92}{0}{0}{acdiagram}
        \label{fig:acdiagram}
      \end{figure}
      \tikzexternaldisable
%      \tikzexfalse

      The \emphbold{Blue}{potential $\gls*{op:pot1e}_{\lambda}$} is chosen for $\gls*{op:hamil}[_{\lambda}]$ to admit the same \emphbold{Blue}{ground density $\gls*{den:ground}$} as $\gls*{op:hamil}[_{1}]$ via the \emphbold{Blue}{ground density matrix $\gls*{op:denen}[_{\lambda}](\gls*{den:ground})$}.

      The \emphbold{Red}{adiabatic connection (AC)}, defined by $\symcal{W}_{\lambda}(\gls*{den:ground}) = \tr \gls*{op:denen}[_{\lambda}](\gls*{den:ground}) \gls*{op:ee}$, can be calculated accurately for small systems to form approximate models for larger systems.
    \end{block}
  \end{column}

  \separatorcolumn

  \begin{column}{\colwidth}
    \begin{block}{2. The Lieb Variational Principle}
      Consider the space of densities $\gls*{struct:denspace}$ and its dual, the space of potentials $\gls*{struct:potspace}$:
      \begin{equation*}
        \gls*{struct:denspace} = L^{3}(\symbb{R}^3) \cap L^{1}(\symbb{R}^3),\quad
        \gls*{struct:potspace} = L^{3/2}(\symbb{R}^3) + L^{\infty}(\symbb{R}^3).
      \end{equation*}
      For every $\lambda$ along the AC, given a \emphbold{Red}{wavefunction method M} to compute the \emphbold{Blue}{M-ground energy $E^{\symup{M}}_{\lambda}(\gls*{op:pot1e})$} of $\gls*{op:hamil}[_{\lambda}](\gls*{op:pot1e})$ and the M-reference density $\gls*{den:ground}[^{\symup{M}}_1] \in \gls*{struct:denspace}$, by finding the \emphbold{Blue}{Lieb universal functional}
      \begin{equation*}
        F^{\symup{M}}_{\lambda}(\gls*{den:ground}[^{\symup{M}}_1])
          = \sup_{\gls*{op:pot1e} \in \gls*{struct:potspace}}
          \,\left[%
            E^{\symup{M}}_{\lambda}(\gls*{op:pot1e})
            - \int \gls*{op:pot1e}(\gls*{bas:spatialcoord}) \gls*{den:ground}[^{\symup{M}}_1](\gls*{bas:spatialcoord}) \ \symup{d} \gls*{bas:spatialcoord}%
          \right]
          \equiv \sup_{\gls*{op:pot1e} \in \gls*{struct:potspace}}
          G^{\symup{M}}_{\lambda}(\gls*{op:pot1e}; \gls*{den:ground}[^{\symup{M}}_1]),
      \end{equation*}
      one obtains the \emphbold{Blue}{M-optimal potential $\gls*{op:pot1e}^{\symup{M}}_{\lambda}$} that
      \begin{itemize}
        \item supports $\gls*{den:ground}^{\symup{M}}_{\lambda}$ as its ground density; and
        \item minimises the \emphbold{Blue}{Lieb-variational errors $\lVert \gls*{den:ground}^{\symup{M}}_{\lambda} - \gls*{den:ground}[^{\symup{M}}_1] \rVert_p$}, $1 \le p \le 3$.
      \end{itemize}

      How well $\gls*{op:pot1e}^{\symup{M}}_{\lambda}$ approximates the true potential $\gls*{op:pot1e}_{\lambda}$ depends on the \emphbold{Red}{quality of the method M} and on \emphbold{Red}{whether $\gls*{op:pot1e}_{\lambda}$ actually exists in $\gls*{struct:potspace}$}.

%      The higher the quality of the wavefunction method M:
%      \begin{itemize}
%        \item the better $\gls*{den:ground}[^{\symup{M}}_1]$ approximates the true reference density $\gls*{den:ground}$;
%%        \item the lower the \emphbold{Blue}{Lieb-variational errors $\lVert \gls*{den:ground}^{\symup{M}}_{\lambda} - \gls*{den:ground}[^{\symup{M}}_1] \rVert_p$} where $1 \le p \le 3$; and
%        \item the better $\gls*{op:pot1e}^{\symup{M}}_{\lambda}$ approximates the true potential $\gls*{op:pot1e}_{\lambda}$.
%      \end{itemize}

    \end{block}
  \end{column}

  \separatorcolumn
\end{columns}

\begin{columns}[t]
  \separatorcolumn

  \begin{column}{\dimexpr(2\colwidth+\sepwidth)}
    \begin{alertblock}{3. Challenges of Degenerate Systems}
      Consider a Hamiltonian $\gls*{op:hamil}[_{\lambda}](\gls*{op:pot1e})$ having a \emphbold{Blue}{symmetry group $\gls*{struct:gengroup}_{\lambda}(\gls*{op:pot1e})$} and admitting a \emphbold{Red}{degenerate ground wavefunction $\gls*{wf:ground}[^{\symup{M}}_{\lambda}](\gls*{op:pot1e})$} with \emphbold{Blue}{energy $E^{\symup{M}}_{\lambda}(\gls*{op:pot1e})$} and \emphbold{Blue}{density $\gls*{den:ground}[_{\lambda}^{\symup{M}}](\gls*{bas:spatialcoord}; \gls*{op:pot1e})$}.

      \vspace{1ex}
      \begin{center}
        \tcbox[%
          enhanced,%
          width=\colwidth,%
          fontupper=\Large,
          colframe=Red,
          colback=Red!10!white,
          overlay,%
          remember as=nonconvbox,%
        ]{
          \emphbold{Red}{Non-convergence} in Lieb optimisation at $\lambda \ne 1$.
        }%
      \end{center}%

      \begin{columns}[t]
        \begin{column}{\dimexpr(.65\colwidth)}
          \centering
          \begin{highlightbox}[height=14.5cm, remember as=gradbox]{highlightorange}{Well-defined gradient?}{\faQuestionCircle[regular]}
            The Lieb optimisation procedure to obtain the M-optimal potential $\gls*{op:pot1e}^{\symup{M}}_{\lambda}$ requires the functional derivative
            \begin{equation*}
              \frac{%
                \delta G^{\symup{M}}_{\lambda}(\gls*{op:pot1e}; \gls*{den:ground}[^{\symup{M}}_1])%
              }{%
                \delta \gls*{op:pot1e}(\gls*{bas:spatialcoord})%
              }
              = \textcolor{Blue}{%
                \frac{%
                  \delta E^{\symup{M}}_{\lambda}(\gls*{op:pot1e})%
                }{%
                  \delta \gls*{op:pot1e}(\gls*{bas:spatialcoord})%
                }%
              } - \gls*{den:ground}[^{\symup{M}}_1](\gls*{bas:spatialcoord}).
            \end{equation*}
            As the degenerate density $\gls*{den:ground}[_{\lambda}^{\symup{M}}](\gls*{bas:spatialcoord}; \gls*{op:pot1e})$ is not invariant under all of $\gls*{struct:gengroup}_{\lambda}(\gls*{op:pot1e})$, $\textcolor{Blue}{%
              \delta E^{\symup{M}}_{\lambda}(\gls*{op:pot1e}) / \delta \gls*{op:pot1e}(\gls*{bas:spatialcoord})%
            }$ is \emphbold{Red}{not unique}:
            \begin{equation*}
              \textcolor{Blue}{%
                \frac{%
                  \delta E^{\symup{M}}_{\lambda}(\gls*{op:pot1e})%
                }{%
                  \delta \gls*{op:pot1e}(\gls*{bas:spatialcoord})%
                }%
              } =
              \sum_{i=1}^{\lvert\gls*{struct:gengroup}_{\lambda}(\gls*{op:pot1e})\rvert}
                c_i
                \hat{g}_i
                \gls*{den:ground}[_{\lambda}^{\symup{M}}](\gls*{bas:spatialcoord}; \gls*{op:pot1e}),
              \quad
              g_i \in \gls*{struct:gengroup}_{\lambda}(\gls*{op:pot1e}),
              \ c_i \ge 0,
              \ \sum_{i=1}^{\lvert\gls*{struct:gengroup}_{\lambda}(\gls*{op:pot1e})\rvert} c_i = 1.
            \end{equation*}
          \end{highlightbox}
        \end{column}

        \begin{column}{\dimexpr(.65\colwidth)}
          \centering
          \begin{highlightbox}[height=14.5cm, remember as=sympotbox]{highlightviolet}{Symmetry of potential?}{\faQuestionCircle[regular]}
            At all $\lambda$, the M-optimal potential $\gls*{op:pot1e}[^{\symup{M}}_{\lambda}]$ determines the \emphbold{Red}{symmetry group} of the Hamiltonian:
            \begin{alignat*}{4}
              \lambda = 1:   &\quad \gls*{op:pot1e}[_{\symup{ext}}] &&\mapsto \gls*{struct:gengroup}_1(\gls*{op:pot1e}[_{\symup{ext}}]) \quad &&\textrm{physical system},\\[6pt]
              0 \le \lambda < 1: &\quad \gls*{op:pot1e}[^{\symup{M}}_{\lambda}] &&\mapsto \gls*{struct:gengroup}_{\lambda}(\gls*{op:pot1e}[^{\symup{M}}_{\lambda}]) \quad &&\textrm{auxiliary systems}.
            \end{alignat*}
            Is \emphbold{Red}{equality} in the following condition
            \begin{equation*}
              \gls*{struct:gengroup}_1(\gls*{op:pot1e}[_{\symup{ext}}]) \ge \gls*{struct:gengroup}_{\lambda}(\gls*{op:pot1e}[^{\symup{M}}_{\lambda}]),
              \quad
              \lambda \ne 1
            \end{equation*}
            necessary?
            In other words, do the \emphbold{Blue}{auxiliary systems} have to \emphbold{Red}{respect} the symmetry of the \emphbold{Blue}{physical system}?
          \end{highlightbox}
        \end{column}

        \begin{column}{\dimexpr(.65\colwidth)}
          \centering
          \begin{highlightbox}[height=14.5cm, remember as=vrepbox]{highlightgreen}{Pure-state $\symbfit{v}$-representability (PSVR)?}{\faQuestionCircle[regular]}
            The \emphbold{Blue}{continuity} of the AC $\symcal{W}_{\lambda}(\gls*{den:ground})$ requires the \emphbold{Blue}{reference density $\gls*{den:ground}$} to be \emphbold{Blue}{$v$-representable $\forall \lambda \in \interval{0}{1}$}.
            However, general $v$-representability conditions for densities in $\gls*{struct:denspace}$ are not well-established.

            In particular, consider the degenerate pure-state ground density $\gls*{den:ground}[^{\symup{M}}_1]$ as the reference density: there is no guarantee that it is \emphbold{Red}{pure-state $v$-representable} $\forall \lambda \in \interval{0}{1}$.\\
            $\Leftrightarrow$ There can exist $\lambda$ values at which the M-optimal potential $\gls*{op:pot1e}^{\symup{M}}_{\lambda}$ supports a ground density $\gls*{den:ground}^{\symup{M}}_{\lambda}$ such that the Lieb-variational errors $\lVert \gls*{den:ground}^{\symup{M}}_{\lambda} - \gls*{den:ground}[^{\symup{M}}_1] \rVert_p$ can get arbitrarily large.
          \end{highlightbox}
        \end{column}
      \end{columns}

      \vspace{2cm}

      \begin{columns}[t]
        \begin{column}{\dimexpr(.65\colwidth)}
          \centering
          \begin{highlightbox}[height=10.95cm, remember as=denalignbox]{highlightorange}{Density alignment}{\faCheckCircle[regular]}
            The uniqueness of $\textcolor{Blue}{%
              \delta E^{\symup{M}}_{\lambda}(\gls*{op:pot1e}) / \delta \gls*{op:pot1e}(\gls*{bas:spatialcoord})%
            }$ is enforced by \emphbold{Red}{choosing}
            \begin{equation*}
              \textcolor{Blue}{%
                \frac{%
                  \delta E^{\symup{M}}_{\lambda}(\gls*{op:pot1e})%
                }{%
                  \delta \gls*{op:pot1e}(\gls*{bas:spatialcoord})%
                }%
              }
              = \hat{g} \gls*{den:ground}[_{\lambda}^{\symup{M}}](\gls*{bas:spatialcoord}; v),
              \quad
              g \in \gls*{struct:gengroup}_1(\gls*{op:pot1e}[_{\symup{ext}}])
            \end{equation*}
            such that $\hat{g} \gls*{den:ground}[_{\lambda}^{\symup{M}}](\gls*{bas:spatialcoord}; v)$ is in the \emphbold{Red}{same symmetry gauge} as $\gls*{den:ground}[_{1}^{\symup{M}}](\gls*{bas:spatialcoord})$, \textit{i.e.} both densities are invariant under the same subgroup of $\gls*{struct:gengroup}_1(\gls*{op:pot1e}[_{\symup{ext}}])$.
          \end{highlightbox}
        \end{column}

        \begin{column}{\dimexpr(.65\colwidth)}
          \centering
          \begin{highlightbox}[height=10.95cm, remember as=potsymconsbox]{highlightviolet}{Potential symmetry constraint}{\faCheckCircle[regular]}
            In the simplest \textit{Ansatz},  at any $\lambda \in \interval{0}{1}$, the constraint
            \begin{equation*}
              \gls*{struct:gengroup}_1(\gls*{op:pot1e}[_{\symup{ext}}]) \mathbin{\textcolor{Red}{=}} \gls*{struct:gengroup}_{\lambda}(\gls*{op:pot1e})
            \end{equation*}
             is imposed for \emphbold{Blue}{all trial potentials $\gls*{op:pot1e}$} to assist convergence in the Lieb optimisation.

            The necessity of this constraint can then be systematically investigated by relaxing to subgroups of $\gls*{struct:gengroup}_1(\gls*{op:pot1e}[_{\symup{ext}}])$.
          \end{highlightbox}
        \end{column}

        \begin{column}{\dimexpr(.65\colwidth)}
          \centering
          \begin{highlightbox}[height=10.95cm, remember as=totsymendenbox]{highlightgreen}{Totally symmetric ensemble density}{\faCheckCircle[regular]}
            Consider instead the ensemble density
            \begin{equation*}
              \frac{1}{\lvert\gls*{struct:gengroup}_1\rvert}
              \sum_{i=1}^{\lvert\gls*{struct:gengroup}_1\rvert}
                \hat{g}_i
                \gls*{den:ground}[_{1}^{\symup{M}}](\gls*{bas:spatialcoord}),
              \quad
              g_i \in \gls*{struct:gengroup}_1(\gls*{op:pot1e}[_{\symup{ext}}]) \equiv \gls*{struct:gengroup}_1
            \end{equation*}
            as the reference density, which is invariant under all of $\gls*{struct:gengroup}_1(\gls*{op:pot1e}[_{\symup{ext}}])$ and \emphbold{Red}{not skewed} towards any particular degenerate component.
          \end{highlightbox}
        \end{column}
      \end{columns}

      \tikzexternaldisable
      \begin{tikzpicture}[overlay, remember picture]
        % Top arrows
        \draw[-{>[length=7mm, width=8mm]}, rounded corners=9pt, line width=1.7mm, Red] (nonconvbox) -| ($(vrepbox.north) + (0, 1.5ex)$);
        \draw[-{>[length=7mm, width=8mm]}, rounded corners=9pt, line width=1.7mm, Red] (nonconvbox) -- ($(sympotbox.north) + (0, 1.5ex)$);
        \draw[-{>[length=7mm, width=8mm]}, rounded corners=9pt, line width=1.7mm, Red] (nonconvbox) -| ($(gradbox.north) + (0, 1.5ex)$);
        % Bottom arrows
        \draw[-{>[length=7mm, width=8mm]}, rounded corners=9pt, line width=1.7mm, Red] (gradbox) -- ($(denalignbox.north) + (0, 1.5ex)$);
        \draw[-{>[length=7mm, width=8mm]}, rounded corners=9pt, line width=1.7mm, Red] (sympotbox) -- ($(potsymconsbox.north) + (0, 1.5ex)$);
        \draw[-{>[length=7mm, width=8mm]}, rounded corners=9pt, line width=1.7mm, Red] (vrepbox) -- ($(totsymendenbox.north) + (0, 1.5ex)$);
      \end{tikzpicture}
      \tikzexternalenable
      \vspace{-0.5cm}
    \end{alertblock}
  \end{column}

  \separatorcolumn
\end{columns}

\begin{columns}[t]
  \separatorcolumn

  \begin{column}{1.37\colwidth}

    \begin{block}{4. $\symbfit{v}$-Representability in the Adiabatic Connection}
      \vspace{-1.0cm}
      \tikzextrue
      \tikzexternalenable
      \begin{figure}
        \centering
        \begin{subfigure}[t]{0.80\colwidth}
          \subcaption{\emphbold{Blue}{Pure-state} density vs. \emphbold{Red}{ensemble} density ACs.}
          \useexternalfile{0.83}{0}{0}{ac_C_O}
        \end{subfigure}
        \begin{subfigure}[t]{0.54\colwidth}
          \subcaption{%
            Exchange-correlation potentials in \emphbold{Red}{ensemble} density ACs.%
          }
          \useexternalfile{0.83}{0}{0}{pot_C_O}
        \end{subfigure}
      \end{figure}
      \tikzexternaldisable
      \tikzexfalse
    \end{block}

  \end{column}

  \halfseparatorcolumn

  \begin{column}{\dimexpr(0.63\colwidth+0.5\sepwidth)}
    \begin{alertblock}{5. Discussion}
      \emphbold{darkblue}{\underline{Tackling the degeneracy challenges}}
      \begin{itemize}
        \item \emphbold{highlightorange}{Density alignment} guarantees well-defined gradients for asymmetric densities.
        \item \emphbold{highlightviolet}{Constraining} the potential to be \emphbold{highlightviolet}{totally symmetric} speeds up convergence by limiting $\gls*{struct:potspace}$ to symmetry-sensible subspaces.
        \item \emphbold{highlightgreen}{Totally symmetric ensemble densities} ensure $v$-representability by avoiding unphysical HOMO--LUMO inversions.
      \end{itemize}
      \emphbold{darkblue}{\underline{Results}}
      \begin{itemize}
        \item \emphbold{Red}{Smooth} ACs for open-shell degenerate atoms with \emphbold{Red}{acceptable} Lieb-variational errors
        \item Exchange-correlation potentials with \emphbold{Red}{qualitatively reasonable} features
      \end{itemize}
    \end{alertblock}

    \begin{block}{References}

      \AtNextBibliography{\footnotesize}
      \nocite{*}
      \begin{center}\mbox{}\vspace{-\baselineskip}
        \printbibliography[heading=none]
      \end{center}

    \end{block}

  \end{column}

  \separatorcolumn
\end{columns}
\end{frame}

\end{document}
